<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <template id="br_deliverable_resource_report">
            <t t-call="report.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="report.internal_layout">
                        <div class="page">
                            <h3><span t-field="res_company.name"/></h3>
                            <table class="table table-bordered" style="table-collapse:collapse; table-layout:fixed">
                                <tbody>
                                    <tr>
                                        <th colspan="3">Business Requirement</th>
                                        <th colspan="3">Customer</th>
                                    </tr>
                                    <tr>
                                        <td colspan="3"><span t-field="o.name"/>-<span t-field="o.description"/></td>
                                        <td colspan="3"><span t-field="o.partner_id.name"/></td>
                                    </tr>

                                    <tr>
                                        <th colspan="2">Project</th>
                                        <th colspan="2">Change Request</th>
                                        <th colspan="2">Category</th>
                                    </tr>
                                    <tr>
                                        <td colspan="2"><span t-field="o.project_id.name"/></td>
                                        <td colspan="2">
                                            <t t-if="o.change_request">Yes</t>
                                            <t t-if="not o.change_request">No</t>
                                        </td>
                                        <td colspan="2">
                                            <t t-foreach="o.category_ids" t-as="cate">
                                                <span t-field="cate.name"/>&#9;
                                            </t>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th colspan="2">Creation</th>
                                        <th colspan="2">Confirmation</th>
                                        <th colspan="2">Approval</th>
                                    </tr>
                                    <tr>
                                        <th >Date</th>
                                        <th >User</th>
                                        <th >Date</th>
                                        <th >User</th>
                                        <th >Date</th>
                                        <th >User</th>
                                    </tr>
                                    <tr>
                                        <td >
                                            <span t-field="o.create_date"/>
                                        </td>
                                        <td>
                                            <span t-field="o.create_uid.name"/>
                                        </td>
                                        <td >
                                            <span t-field="o.confirmation_date"/>
                                        </td>
                                        <td>
                                            <span t-field="o.confirmed_id.name"/>
                                        </td>
                                        <td >
                                            <span t-field="o.approval_date"/>
                                        </td>
                                        <td>
                                            <span t-field="o.approved_id.name"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <t t-if="o.business_requirement">
                                <h3>Customer Story:</h3>
                                <table class="table table-bordered">
                                    <tbody>
                                        <tr>
                                            <td><span t-field="o.business_requirement"/></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </t>
                            <t t-if="o.scenario">
                                <h3>Scenario:</h3>
                                <table class="table table-bordered">
                                    <tbody>
                                        <tr>
                                            <td><span t-field="o.scenario"/></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </t>
                            <t t-if="o.gap">
                                <h3>Gap:</h3>
                                <table class="table table-bordered">
                                    <tbody>
                                        <tr>
                                            <td><span t-field="o.gap"/></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </t>
                        </div>
                    </t>

                    <t t-foreach="o.deliverable_lines" t-as='deliverable'>
                        <t t-call="report.internal_layout">
                            <div class="page">
                                <h3>Deliverable <span t-esc="deliverable_index + 1"/>:</h3>
                                <table class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Product</th>
                                            <th>UoM</th>
                                            <th>Quantity</th>
                                            <th>Price</th>
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><span t-field="deliverable.name"/></td>
                                            <td>
                                                [<span t-field="deliverable.product_id.default_code"/>]
                                                <span t-field="deliverable.product_id.name_template"/>
                                            </td>
                                            <td><span t-field="deliverable.uom_id.name"/></td>
                                            <td><span t-field="deliverable.qty"/></td>
                                            <td><span t-field="deliverable.unit_price"/></td>
                                            <td><span t-field="deliverable.price_total"/></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <t t-if="deliverable.resource_ids">
                                    <h3>Resource lines for deliverable <span t-esc="deliverable_index + 1"/>:</h3>
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Type</th>
                                                <th>Name</th>
                                                <th>Product</th>
                                                <th>Qty</th>
                                                <th>UoM</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <t t-foreach="deliverable.resource_ids" t-as="resource">
                                                <tr>
                                                    <td><span t-field="resource.resource_type"/></td>
                                                    <td><span t-field="resource.name"/></td>
                                                    <td>
                                                        [<span t-field="resource.product_id.default_code"/>]
                                                        <span t-field="resource.product_id.name_template"/>
                                                    </td>
                                                    <td><span t-field="resource.qty"/></td>
                                                    <td><span t-field="resource.uom_id.name"/></td>
                                                </tr>
                                            </t>
                                        </tbody>
                                    </table>
                                </t>
                            </div>
                        </t>
                    </t>
                </t>
            </t>
        </template>
    </data>
</openerp>
